{"ast":null,"code":"import _classCallCheck from \"/Users/frida/teamdagarna/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/frida/teamdagarna/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _regeneratorRuntime from \"/Users/frida/teamdagarna/node_modules/@babel/runtime/regenerator/index.js\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { AngularFirestore } from 'angularfire2/firestore';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { map } from 'rxjs/operators';\nimport * as _ from 'lodash';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"angularfire2/firestore\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\n\nfunction TreasurecodesComponent_option_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var company_r4 = ctx.$implicit;\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"value\", company_r4.id);\n    i0.ɵɵproperty(\"selected\", company_r4.id == ctx_r0.preselected)(\"disabled\", ctx_r0.hasCodeTuesday(company_r4.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(company_r4.name);\n  }\n}\n\nfunction TreasurecodesComponent_ng_container_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    var code_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", code_r5.companyname, \": \", code_r5.treasurecode, \"\");\n  }\n}\n\nfunction TreasurecodesComponent_option_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var company_r6 = ctx.$implicit;\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"value\", company_r6.id);\n    i0.ɵɵproperty(\"selected\", company_r6.id == ctx_r2.preselected)(\"disabled\", ctx_r2.hasCodeWednesday(company_r6.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(company_r6.name);\n  }\n}\n\nfunction TreasurecodesComponent_ng_container_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    var code_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", code_r7.companyname, \": \", code_r7.treasurecode, \"\");\n  }\n}\n\nvar _c0 = function _c0(a0) {\n  return {\n    \"is-loading\": a0\n  };\n};\n\nexport var TreasurecodesComponent = /*#__PURE__*/(function () {\n  var TreasurecodesComponent = /*#__PURE__*/function () {\n    function TreasurecodesComponent(afs, fb) {\n      var _this = this;\n\n      _classCallCheck(this, TreasurecodesComponent);\n\n      this.afs = afs;\n      this.fb = fb;\n      this.loading1 = false;\n      this.loading2 = false;\n      this.getCompaniesTuesday().subscribe(function (companies) {\n        _this.treasureCompaniesTuesday = companies;\n      });\n      this.getCompaniesWednesday().subscribe(function (companies) {\n        _this.treasureCompaniesWednesday = companies;\n      });\n      this.getTreasureCodesTuesday().subscribe(function (codes) {\n        _this.treasureCodesTuesday = codes;\n      });\n      this.getTreasureCodesWednesday().subscribe(function (codes) {\n        _this.treasureCodesWednesday = codes;\n      });\n    }\n\n    _createClass(TreasurecodesComponent, [{\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        this.treasureGenerateFormTuesday = this.fb.group({\n          'comp': ['', [Validators.required]]\n        });\n        this.treasureGenerateFormWednesday = this.fb.group({\n          'comp': ['', [Validators.required]]\n        });\n      }\n    }, {\n      key: \"getCompaniesTuesday\",\n      value: function getCompaniesTuesday() {\n        return this.afs.collection('companies', function (ref) {\n          return ref.where('treasurehuntTuesday', '==', true);\n        }).snapshotChanges().pipe(map(function (actions) {\n          return actions.map(function (a) {\n            var data = a.payload.doc.data();\n            var id = a.payload.doc.id;\n            return Object.assign({\n              id: id\n            }, data);\n          });\n        }));\n      }\n    }, {\n      key: \"getCompaniesWednesday\",\n      value: function getCompaniesWednesday() {\n        return this.afs.collection('companies', function (ref) {\n          return ref.where('treasurehuntWednesday', '==', true);\n        }).snapshotChanges().pipe(map(function (actions) {\n          return actions.map(function (a) {\n            var data = a.payload.doc.data();\n            var id = a.payload.doc.id;\n            return Object.assign({\n              id: id\n            }, data);\n          });\n        }));\n      }\n    }, {\n      key: \"getTreasureCodesTuesday\",\n      value: function getTreasureCodesTuesday() {\n        return this.afs.collection('treasurecodesTuesday').valueChanges();\n      }\n    }, {\n      key: \"getTreasureCodesWednesday\",\n      value: function getTreasureCodesWednesday() {\n        return this.afs.collection('treasurecodesWednesday').valueChanges();\n      }\n    }, {\n      key: \"hasCodeTuesday\",\n      value: function hasCodeTuesday(company) {\n        if (_.find(this.treasureCodesTuesday, function (o) {\n          return o.company == company;\n        }) !== undefined) {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }, {\n      key: \"hasCodeWednesday\",\n      value: function hasCodeWednesday(company) {\n        if (_.find(this.treasureCodesWednesday, function (o) {\n          return o.company == company;\n        }) !== undefined) {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }, {\n      key: \"getTreasureCompanyTuesday\",\n      value: function getTreasureCompanyTuesday(company) {\n        this.treasureCompanyTuesday = _.find(this.treasureCompaniesTuesday, {\n          'id': company\n        });\n      }\n    }, {\n      key: \"getTreasureCompanyWednesday\",\n      value: function getTreasureCompanyWednesday(company) {\n        this.treasureCompanyWednesday = _.find(this.treasureCompaniesWednesday, {\n          'id': company\n        });\n      }\n    }, {\n      key: \"submitTuesday\",\n      value: function submitTuesday(data) {\n        return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var randomstring, newCode;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  // var randomstring = 'test';\n                  randomstring = data.comp.substring(0, 3) + _.random(1000, 9999);\n                  this.loading1 = true;\n                  newCode = {\n                    company: data.comp,\n                    companyname: this.treasureCompanyTuesday.name,\n                    treasurecode: randomstring\n                  };\n                  _context.prev = 3;\n                  _context.next = 6;\n                  return this.afs.collection('treasurecodesTuesday').add(newCode);\n\n                case 6:\n                  _context.next = 11;\n                  break;\n\n                case 8:\n                  _context.prev = 8;\n                  _context.t0 = _context[\"catch\"](3);\n                  console.log(_context.t0);\n\n                case 11:\n                  this.loading1 = false;\n\n                case 12:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this, [[3, 8]]);\n        }));\n      }\n    }, {\n      key: \"submitWednesday\",\n      value: function submitWednesday(data) {\n        return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          var randomstring, newCode;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  // var randomstring = 'test';\n                  randomstring = data.comp.substring(0, 3) + _.random(1000, 9999);\n                  this.loading2 = true;\n                  newCode = {\n                    company: data.comp,\n                    companyname: this.treasureCompanyWednesday.name,\n                    treasurecode: randomstring\n                  };\n                  _context2.prev = 3;\n                  _context2.next = 6;\n                  return this.afs.collection('treasurecodesWednesday').add(newCode);\n\n                case 6:\n                  _context2.next = 11;\n                  break;\n\n                case 8:\n                  _context2.prev = 8;\n                  _context2.t0 = _context2[\"catch\"](3);\n                  console.log(_context2.t0);\n\n                case 11:\n                  this.loading2 = false;\n\n                case 12:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this, [[3, 8]]);\n        }));\n      }\n    }]);\n\n    return TreasurecodesComponent;\n  }();\n\n  TreasurecodesComponent.ɵfac = function TreasurecodesComponent_Factory(t) {\n    return new (t || TreasurecodesComponent)(i0.ɵɵdirectiveInject(i1.AngularFirestore), i0.ɵɵdirectiveInject(i2.FormBuilder));\n  };\n\n  TreasurecodesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TreasurecodesComponent,\n    selectors: [[\"app-treasurecodes\"]],\n    decls: 36,\n    vars: 14,\n    consts: [[1, \"title\", \"is-2\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"field\"], [1, \"label\"], [1, \"control\", \"has-icons-left\"], [1, \"select\", \"is-primary\", \"is-large\", \"is-fullwidth\"], [\"formControlName\", \"comp\", 3, \"ngModelChange\"], [\"value\", \"-1\"], [3, \"value\", \"selected\", \"disabled\", 4, \"ngFor\", \"ngForOf\"], [1, \"icon\", \"is-small\", \"is-left\"], [1, \"far\", \"fa-building\"], [\"type\", \"submit\", 1, \"button\", \"is-fullwidth\", \"is-primary\", 3, \"ngClass\", \"disabled\"], [4, \"ngFor\", \"ngForOf\"], [3, \"value\", \"selected\", \"disabled\"]],\n    template: function TreasurecodesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\", 0);\n        i0.ɵɵtext(1, \"Tisdag\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"form\", 1);\n        i0.ɵɵlistener(\"ngSubmit\", function TreasurecodesComponent_Template_form_ngSubmit_2_listener() {\n          return ctx.submitTuesday(ctx.treasureGenerateFormTuesday.value);\n        });\n        i0.ɵɵelementStart(3, \"div\", 2)(4, \"label\", 3);\n        i0.ɵɵtext(5, \"V\\xE4lj f\\xF6retag\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"select\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function TreasurecodesComponent_Template_select_ngModelChange_8_listener($event) {\n          return ctx.getTreasureCompanyTuesday($event);\n        });\n        i0.ɵɵelementStart(9, \"option\", 7);\n        i0.ɵɵtext(10, \"V\\xE4lj f\\xF6retag\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(11, TreasurecodesComponent_option_11_Template, 2, 4, \"option\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 9);\n        i0.ɵɵelement(13, \"i\", 10);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(14, \"button\", 11);\n        i0.ɵɵtext(15, \"Generera\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(16, \"br\");\n        i0.ɵɵtemplate(17, TreasurecodesComponent_ng_container_17_Template, 3, 2, \"ng-container\", 12);\n        i0.ɵɵelementStart(18, \"h1\", 0);\n        i0.ɵɵtext(19, \"Onsdag\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"form\", 1);\n        i0.ɵɵlistener(\"ngSubmit\", function TreasurecodesComponent_Template_form_ngSubmit_20_listener() {\n          return ctx.submitWednesday(ctx.treasureGenerateFormWednesday.value);\n        });\n        i0.ɵɵelementStart(21, \"div\", 2)(22, \"label\", 3);\n        i0.ɵɵtext(23, \"V\\xE4lj f\\xF6retag\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 4)(25, \"div\", 5)(26, \"select\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function TreasurecodesComponent_Template_select_ngModelChange_26_listener($event) {\n          return ctx.getTreasureCompanyWednesday($event);\n        });\n        i0.ɵɵelementStart(27, \"option\", 7);\n        i0.ɵɵtext(28, \"V\\xE4lj f\\xF6retag\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(29, TreasurecodesComponent_option_29_Template, 2, 4, \"option\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(30, \"div\", 9);\n        i0.ɵɵelement(31, \"i\", 10);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(32, \"button\", 11);\n        i0.ɵɵtext(33, \"Generera\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(34, \"br\");\n        i0.ɵɵtemplate(35, TreasurecodesComponent_ng_container_35_Template, 3, 2, \"ng-container\", 12);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formGroup\", ctx.treasureGenerateFormTuesday);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngForOf\", ctx.treasureCompaniesTuesday);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(10, _c0, ctx.loading1))(\"disabled\", false);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.treasureCodesTuesday);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"formGroup\", ctx.treasureGenerateFormWednesday);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngForOf\", ctx.treasureCompaniesWednesday);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(12, _c0, ctx.loading2))(\"disabled\", false);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.treasureCodesWednesday);\n      }\n    },\n    directives: [i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.FormControlName, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i3.NgForOf, i3.NgClass],\n    styles: [\"\"]\n  });\n  return TreasurecodesComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}