{"ast":null,"code":"import _classCallCheck from \"/Users/frida/teamdagarna/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/frida/teamdagarna/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { AuthService } from '../../services/auth.service';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../services/auth.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\n\nfunction SigninComponent_div_1_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1, \" M\\xE5ste skriva in ditt Liu-ID \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nvar _c0 = function _c0(a0) {\n  return {\n    \"is-loading\": a0\n  };\n};\n\nvar _c1 = function _c1() {\n  return [\"/signup\"];\n};\n\nvar _c2 = function _c2() {\n  return [\"/forgotpass\"];\n};\n\nfunction SigninComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"form\", 4);\n    i0.ɵɵlistener(\"ngSubmit\", function SigninComponent_div_1_Template_form_ngSubmit_1_listener() {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.login(ctx_r3.loginForm.value);\n    });\n    i0.ɵɵelementStart(2, \"div\", 5)(3, \"div\", 6)(4, \"div\", 7)(5, \"div\", 8)(6, \"h3\", 9);\n    i0.ɵɵtext(7, \"Logga in\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"h3\", 10);\n    i0.ɵɵtext(9, \"Om du inte tidigare varit inloggad p\\xE5 TEAM 2021 s\\xE5 ber vi dig skapa ett nytt konto via \\\"Skapa konto\\\" nedan.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 11)(11, \"label\", 12);\n    i0.ɵɵtext(12, \"Liu-ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"input\", 13);\n    i0.ɵɵtemplate(14, SigninComponent_div_1_div_14_Template, 2, 0, \"div\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"div\", 11)(16, \"label\", 15);\n    i0.ɵɵtext(17, \"L\\xF6senord\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"input\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"p\", 17);\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"button\", 18);\n    i0.ɵɵtext(22, \"Logga in\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"div\", 19)(24, \"a\", 20)(25, \"p\");\n    i0.ɵɵelement(26, \"i\", 21);\n    i0.ɵɵtext(27, \" Skapa konto \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(28, \"a\", 20)(29, \"p\");\n    i0.ɵɵelement(30, \"i\", 22);\n    i0.ɵɵtext(31, \" Gl\\xF6mt l\\xF6senord \");\n    i0.ɵɵelementEnd()()()()()()()()();\n  }\n\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.loginForm);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.liuid.invalid && ctx_r0.liuid.touched);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(ctx_r0.errorMessage);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(7, _c0, ctx_r0.loading))(\"disabled\", !ctx_r0.loginForm.valid);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(9, _c1));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(10, _c2));\n  }\n}\n\nvar _c3 = function _c3() {\n  return [\"\"];\n};\n\nfunction SigninComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"div\", 5)(2, \"h1\", 25);\n    i0.ɵɵtext(3, \"Snyggt, du \\xE4r redan inloggad! Klicka p\\xE5 pusselbiten f\\xF6r att ta dig till startsidan :)\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵelementStart(5, \"div\", 5)(6, \"figure\", 26)(7, \"a\", 20);\n    i0.ɵɵelement(8, \"img\", 27);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c3));\n  }\n}\n\nexport var SigninComponent = /*#__PURE__*/(function () {\n  var SigninComponent = /*#__PURE__*/function () {\n    // detailForm: FormGroup;\n    function SigninComponent(fb, auth, router) {\n      _classCallCheck(this, SigninComponent);\n\n      this.fb = fb;\n      this.auth = auth;\n      this.router = router;\n      this.loading = false;\n    }\n\n    _createClass(SigninComponent, [{\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        // First Step\n        this.loginForm = this.fb.group({\n          'liuid': ['', [Validators.pattern('[A-Za-z]{4,5}[0-9]{3}$'), Validators.required]],\n          'password': ['', [Validators.required]]\n        }); // Second Step\n        // this.detailForm = this.fb.group({\n        //   'catchPhrase': ['', [ Validators.required ] ]\n        // });\n      } // Using getters will make your code look pretty\n\n    }, {\n      key: \"liuid\",\n      get: function get() {\n        return this.loginForm.get('liuid');\n      }\n    }, {\n      key: \"password\",\n      get: function get() {\n        return this.loginForm.get('password');\n      } // get catchPhrase() { return this.detailForm.get('catchPhrase') }\n\n    }, {\n      key: \"login\",\n      value: function login(data) {\n        var _this = this;\n\n        this.loading = true;\n        var liumail = data.liuid + '@student.liu.se';\n        console.log(liumail);\n        this.auth.emailLogin(liumail, data.password).then(function (res) {\n          _this.loading = false;\n\n          _this.router.navigate(['']); //Checks if request comes from the app. If user logs in the info in the navbar will change in the app.\n\n\n          if (navigator.userAgent.indexOf('gonative') > -1) {\n            var info = {\n              userId: _this.auth.getUserID(),\n              userEmail: _this.auth.getUserEmail()\n            };\n            var json = JSON.stringify(info);\n            setTimeout(function () {\n              window.location.href = 'gonative://registration/send?customData=' + encodeURIComponent(json);\n            }, 1200);\n          }\n        }).catch(function (error) {\n          _this.loading = false;\n          var errorCode = error.code;\n\n          if (errorCode === 'auth/wrong-password') {\n            _this.errorMessage = 'Verkar inte som att du matat in rätt LiU-ID eller lösenord. Testa igen.';\n          } else if (errorCode === 'auth/invalid-email') {\n            _this.errorMessage = 'Verkar inte som att du matat in rätt LiU-ID eller lösenord. Testa igen.';\n          } else if (errorCode === 'auth/user-not-found') {\n            _this.errorMessage = 'Verkar inte som att du matat in rätt LiU-ID eller lösenord. Har du registrerat dig?';\n          } else {\n            _this.errorMessage = 'Något gick fel. Testa igen.';\n          }\n        });\n      }\n    }]);\n\n    return SigninComponent;\n  }();\n\n  SigninComponent.ɵfac = function SigninComponent_Factory(t) {\n    return new (t || SigninComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.Router));\n  };\n\n  SigninComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SigninComponent,\n    selectors: [[\"app-signin\"]],\n    decls: 3,\n    vars: 2,\n    consts: [[1, \"section\"], [\"class\", \"container\", 4, \"ngIf\"], [\"class\", \"hero container\", 4, \"ngIf\"], [1, \"container\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"columns\", \"is-centered\"], [1, \"column\", \"is-one-third\"], [1, \"card\", \"login-card\"], [1, \"card-content\"], [1, \"title\", \"is-2\"], [1, \"subtitle\", \"is-6\"], [1, \"field\"], [\"for\", \"liuid\", 1, \"label\"], [\"type\", \"text\", \"placeholder\", \"Ditt liu-id\", \"formControlName\", \"liuid\", 1, \"input\"], [\"class\", \"help is-danger\", 4, \"ngIf\"], [\"for\", \"password\", 1, \"label\"], [\"type\", \"password\", \"placeholder\", \"Ditt l\\xF6senord\", \"formControlName\", \"password\", 1, \"input\"], [1, \"error-message\"], [\"type\", \"submit\", 1, \"button\", \"is-fullwidth\", 3, \"ngClass\", \"disabled\"], [1, \"login-other-actions\"], [3, \"routerLink\"], [1, \"fas\", \"fa-plus-circle\"], [1, \"fas\", \"fa-sad-tear\"], [1, \"help\", \"is-danger\"], [1, \"hero\", \"container\"], [1, \"title\", \"is-3\", \"has-text-primary\", \"has-text-centered\"], [1, \"image\", \"is-64x64\"], [\"src\", \"https://firebasestorage.googleapis.com/v0/b/teamdagarna-5fb26.appspot.com/o/ikon.png?alt=media&token=33401086-b60c-4e73-9dbd-66af65d9ea26\"]],\n    template: function SigninComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0);\n        i0.ɵɵtemplate(1, SigninComponent_div_1_Template, 32, 11, \"div\", 1);\n        i0.ɵɵtemplate(2, SigninComponent_div_2_Template, 9, 2, \"div\", 2);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.auth.isSignedIn());\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.auth.isSignedIn());\n      }\n    },\n    directives: [i4.NgIf, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i4.NgClass, i3.RouterLinkWithHref],\n    styles: [\".login-card[_ngcontent-%COMP%]{margin:50px}.login-other-actions[_ngcontent-%COMP%]{padding-top:20px}.image[_ngcontent-%COMP%]{margin:auto}\"]\n  });\n  return SigninComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}